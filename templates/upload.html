<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Ransomware Detector - CyberScan UI</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&display=swap');
    
    * { margin:0; padding:0; box-sizing:border-box; }
    
    body { 
      background: linear-gradient(135deg, #0a0e27 0%, #1a0b2e 50%, #16213e 100%);
      color:#00ff88;
      font-family:'Rajdhani', sans-serif;
      min-height:100vh;
      position:relative;
      overflow-x:hidden;
    }

    /* Hacker grid */
    body::before {
      content:'';
      position:fixed;
      inset:0;
      background: 
        repeating-linear-gradient(0deg, rgba(0,255,136,0.03) 0px, transparent 2px),
        repeating-linear-gradient(90deg, rgba(0,255,136,0.03) 0px, transparent 2px);
      pointer-events:none;
      z-index:1;
    }

    .wrap { width:900px; margin:40px auto; position:relative; z-index:2; }

    /* ‚ùá Neon Card */
    .glow-card {
      background: rgba(10,20,40,0.85);
      backdrop-filter: blur(10px);
      padding:30px;
      border-radius:15px;
      margin-bottom:25px;
      border: 2px solid rgba(0,255,136,0.3);
      box-shadow: 
        0 0 25px rgba(0,255,136,0.1),
        inset 0 0 20px rgba(0,255,136,0.05);
      animation: fadeInUp 0.6s ease forwards;
      opacity:0;
      overflow:hidden;
      transition:all .3s;
    }

    @keyframes fadeInUp {
      from { opacity:0; transform:translateY(30px); }
      to { opacity:1; transform:translateY(0); }
    }

    .glow-card:hover {
      transform: translateY(-3px);
      border-color:#00ff88;
      box-shadow:0 0 35px rgba(0,255,136,0.3), inset 0 0 20px rgba(0,255,136,0.15);
    }

    /* Glitch heading */
    h1 {
      font-family:'Orbitron', monospace;
      font-size:2.8em;
      font-weight:900;
      color:#00ff88;
      text-transform:uppercase;
      text-align:center;
      letter-spacing:4px;
      margin-bottom:25px;
      text-shadow:0 0 20px rgba(0,255,136,0.6);
      animation: glitch 5s infinite, fadeIn 1s ease;
    }

    @keyframes glitch {
      0%,95%,100% { transform:translate(0); }
      96% { transform: translate(-2px, 2px); }
      97% { transform: translate(2px, -2px); }
      98% { transform: translate(-3px, 1px); }
      99% { transform: translate(2px, -1px); }
    }

    h2 {
      color:#00d4ff;
      font-family:'Orbitron', monospace;
      text-transform:uppercase;
      letter-spacing:2px;
      margin-bottom:15px;
      font-size:1.2em;
      text-shadow:0 0 12px rgba(0,212,255,0.7);
      animation: glow 2s ease-in-out infinite alternate;
    }

    @keyframes glow {
      from { text-shadow: 0 0 8px #00d4ff; }
      to { text-shadow: 0 0 20px #00d4ff, 0 0 30px rgba(0,212,255,0.4); }
    }

    /* ==========================
       CUSTOM NEON FILE UPLOADER
       ========================== */
    #fileInput { display:none; }

    .upload-box {
      border: 2px dashed rgba(0,255,136,0.5);
      border-radius: 12px;
      padding: 25px;
      text-align:center;
      cursor:pointer;
      background:rgba(0,255,136,0.05);
      transition:.3s;
      color:#00ff88;
      font-size:1.1em;
      text-shadow:0 0 8px rgba(0,255,136,0.4);
      box-shadow: inset 0 0 15px rgba(0,255,136,0.2);
    }

    .upload-box:hover {
      background:rgba(0,255,136,0.15);
      border-color:#00ff88;
      box-shadow:0 0 20px rgba(0,255,136,0.4), inset 0 0 25px rgba(0,255,136,0.3);
      transform:scale(1.02);
    }

    .upload-box.file-selected {
      color:#00d4ff;
      border-color:#00d4ff;
      text-shadow: 0 0 12px #00d4ff;
      box-shadow: inset 0 0 25px rgba(0,212,255,0.3);
    }

    /* Neon Button */
    .btn {
      background:linear-gradient(135deg, #00ff88, #00d4ff);
      padding:14px 28px;
      border:none;
      border-radius:10px;
      color:#0c0c12;
      font-family:'Orbitron', monospace;
      font-weight:700;
      cursor:pointer;
      margin-top:15px;
      float:right;
      letter-spacing:1px;
      text-transform:uppercase;
      transition:.3s;
      box-shadow:0 0 18px rgba(0,255,136,0.4);
    }

    .btn:hover {
      transform:scale(1.06);
      box-shadow:0 0 25px rgba(0,255,136,0.6);
    }

    .ok { color:#00ff88; text-shadow:0 0 8px #00ff88; }
    .warn { color:#ffcc00; text-shadow:0 0 8px #ffcc00; }
    .bad { color:#ff3366; text-shadow:0 0 8px #ff3366; }

    li {
      padding:8px 0;
      border-bottom:1px solid rgba(0,255,136,0.15);
      transition:.3s;
    }

    li:hover {
      background:rgba(0,255,136,0.08);
      padding-left:10px;
    }

    .grid { display:grid; grid-template-columns:1fr 1fr; gap:25px; }

    @media(max-width:900px){
      .wrap{ width:95%; }
      .grid{ grid-template-columns:1fr; }
    }
</style>
</head>

<body>
<div class="wrap">

  <h1>üîê CYBER-SCANNER v1.0 - Ransomware Detector</h1>

  <!-- Upload Panel -->
  <div class="glow-card">
    <form method="POST" enctype="multipart/form-data">

      <!-- Custom File Uploader -->
      <div class="upload-box" onclick="document.getElementById('fileInput').click()">
          <span id="upload-text">üìÇ Click to Upload </span>
      </div>

      <input id="fileInput" 
             type="file" 
             name="file" 
             accept=".exe,.dll" 
             required 
             onchange="showFileName(event)" />

      <button class="btn" type="submit">Analyze File</button>
    </form>

    {% if error %}
      <p class="bad">‚ö† {{ error }}</p>
    {% endif %}
  </div>

  {% if filename %}
  
  <!-- Uploaded file card -->
  <div class="glow-card">
    <h2>üìÅ Uploaded File</h2>
    <p><strong>{{ filename }}</strong></p>
  </div>

  <div class="grid">

    <!-- Scan Result -->
    <div class="glow-card">
      <h2>üõ° Scan Result</h2>
      <p><strong>Result:</strong>
        {% if 'Benign' in result %}
           <span class="ok">{{ result }}</span>
        {% else %}
           <span class="bad">{{ result }}</span>
        {% endif %}
      </p>

      <p><strong>Benign Probability:</strong> {{ probability }}</p>

      <p><strong>Risk Level:</strong>
        {% if risk == "Low Risk" %}
          <span class="ok">{{ risk }}</span>
        {% elif risk == "Medium Risk" %}
          <span class="warn">{{ risk }}</span>
        {% else %}
          <span class="bad">{{ risk }}</span>
        {% endif %}
      </p>

      <canvas id="gauge" height="160"></canvas>
    </div>

    <!-- Feature Importance -->
    <div class="glow-card">
      <h2>üìà Top Influential Features</h2>
      <canvas id="bar" height="220"></canvas>
    </div>

  </div>

  {% if pdf_file %}
  <div class="glow-card">
    <h2>üìÑ Download PDF Report</h2>
    <a class="btn" href="/download/{{ pdf_file }}">Download Full Report</a>
  </div>
  {% endif %}

  <div class="glow-card">
    <h2>üìä Extracted File Attributes</h2>
    <ul>
      {% for k, v in features.items() %}
        <li><strong>{{ k }}</strong>: {{ v }}</li>
      {% endfor %}
    </ul>
  </div>

  {% endif %}
</div>

<!-- ================= JS ================= -->
<script>
/* Show selected file name */
function showFileName(event) {
    const file = event.target.files[0];
    if (file) {
        const box = document.querySelector(".upload-box");
        const text = document.getElementById("upload-text");

        box.classList.add("file-selected");
        text.textContent = "üìÅ " + file.name;
    }
}

{% if filename %}

/* Gauge Chart */
new Chart(document.getElementById('gauge'), {
  type: 'doughnut',
  data: {
    labels: ["Benign", "Malicious"],
    datasets: [{
      data: [{{ probability }}, 1-{{ probability }}],
      backgroundColor: ["#00eaff", "#ff4d4d"]
    }]
  },
  options: {
    rotation:-90,
    circumference:180,
    cutout:"70%",
    plugins:{ legend:{ display:false } }
  }
});

/* Feature Importance Chart */
new Chart(document.getElementById('bar'), {
  type: 'bar',
  data: {
    labels: {{ chart_labels|tojson }},
    datasets: [{ data: {{ chart_values|tojson }}, backgroundColor:"#00eaff" }]
  },
  options: {
    indexAxis:'y',
    plugins:{ legend:{ display:false } },
    scales:{
      x:{ ticks:{ color:"#00eaff" } },
      y:{ ticks:{ color:"#00eaff" } }
    }
  }
});

{% endif %}
</script>

</body>
</html>
